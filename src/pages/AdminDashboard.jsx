import { createSignal, For, Show, onMount, createEffect } from 'solid-js';
import { createNotification } from '../components/Notification';
import { supabase } from '../supabaseClient';
import { useNavigate } from '@solidjs/router';
import { createStore } from 'solid-js/store';
import Loader from '../components/Loader';

function AdminDashboard() {
  const navigate = useNavigate();
  const { NotificationComponent, showNotification } = createNotification();
  const [loading, setLoading] = createSignal(true);
  const [activeTab, setActiveTab] = createSignal('pages');

  const [pagesData, setPagesData] = createStore({ pages: [] });
  const [blogPostsData, setBlogPostsData] = createStore({ blogPosts: [] });
  const [shopItemsData, setShopItemsData] = createStore({ shopItems: [] });
  const [messagesData, setMessagesData] = createStore({ messages: [] });
  const [usersData, setUsersData] = createStore({ users: [] });

  const fetchData = async () => {
    setLoading(true);
    try {
      const { data: { session } } = await supabase.auth.getSession();

      if (activeTab() === 'pages') {
        const pagesRes = await fetch('/api/getPages', {
          headers: { 'Authorization': `Bearer ${session.access_token}` },
        });

        if (pagesRes.ok) {
          const pagesData = await pagesRes.json();
          setPagesData({ pages: pagesData });
        } else {
          showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงูุตูุญุงุช.', 'error');
        }
      } else if (activeTab() === 'blogPosts') {
        const blogRes = await fetch('/api/getBlogPosts', {
          headers: { 'Authorization': `Bearer ${session.access_token}` },
        });

        if (blogRes.ok) {
          const blogData = await blogRes.json();
          setBlogPostsData({ blogPosts: blogData });
        } else {
          showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงูููุงูุงุช.', 'error');
        }
      } else if (activeTab() === 'shopItems') {
        const shopRes = await fetch('/api/getShopItems', {
          headers: { 'Authorization': `Bearer ${session.access_token}` },
        });

        if (shopRes.ok) {
          const shopData = await shopRes.json();
          setShopItemsData({ shopItems: shopData });
        } else {
          showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงูููุชุฌุงุช.', 'error');
        }
      } else if (activeTab() === 'messages') {
        const messagesRes = await fetch('/api/getMessages', {
          headers: { 'Authorization': `Bearer ${session.access_token}` },
        });

        if (messagesRes.ok) {
          const messagesData = await messagesRes.json();
          setMessagesData({ messages: messagesData });
        } else {
          showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงูุฑุณุงุฆู.', 'error');
        }
      } else if (activeTab() === 'users') {
        const usersRes = await fetch('/api/getUsers', {
          headers: { 'Authorization': `Bearer ${session.access_token}` },
        });

        if (usersRes.ok) {
          const usersData = await usersRes.json();
          setUsersData({ users: usersData.users });
        } else {
          showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงููุณุชุฎุฏููู.', 'error');
        }
      }
    } catch (error) {
      console.error('Error fetching data:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงูุจูุงูุงุช.', 'error');
    } finally {
      setLoading(false);
    }
  };

  onMount(() => {
    fetchData();
  });

  createEffect(() => {
    fetchData();
  });

  const [newPage, setNewPage] = createStore({ id: null, title: '', content: '' });
  const [editingPageId, setEditingPageId] = createSignal(null);

  const [newBlogPost, setNewBlogPost] = createStore({ id: null, title: '', content: '' });
  const [editingBlogPostId, setEditingBlogPostId] = createSignal(null);

  const [newShopItem, setNewShopItem] = createStore({ id: null, name: '', description: '', price: '', imageUrl: '' });
  const [editingShopItemId, setEditingShopItemId] = createSignal(null);

  const handleSavePage = async () => {
    if (!newPage.title || !newPage.content) {
      showNotification('ูุฑุฌู ุชุนุจุฆุฉ ุงูุญููู ุงููุทููุจุฉ.', 'error');
      return;
    }
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const method = editingPageId() ? 'PUT' : 'POST';
      const response = await fetch('/api/savePage', {
        method,
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newPage),
      });

      if (response.ok) {
        showNotification('ุชู ุญูุธ ุงูุตูุญุฉ ุจูุฌุงุญ.', 'success');
        setNewPage({ id: null, title: '', content: '' });
        setEditingPageId(null);
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุตูุญุฉ.', 'error');
      }
    } catch (error) {
      console.error('Error saving page:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุตูุญุฉ.', 'error');
    }
  };

  const handleEditPage = (page) => {
    setNewPage({ ...page });
    setEditingPageId(page.id);
  };

  const handleDeletePage = async (id) => {
    if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูุตูุญุฉุ')) return;
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const response = await fetch('/api/savePage', {
        method: 'DELETE',
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ id }),
      });

      if (response.ok) {
        showNotification('ุชู ุญุฐู ุงูุตูุญุฉ ุจูุฌุงุญ.', 'success');
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุตูุญุฉ.', 'error');
      }
    } catch (error) {
      console.error('Error deleting page:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุตูุญุฉ.', 'error');
    }
  };

  const handleSaveBlogPost = async () => {
    if (!newBlogPost.title || !newBlogPost.content) {
      showNotification('ูุฑุฌู ุชุนุจุฆุฉ ุงูุญููู ุงููุทููุจุฉ.', 'error');
      return;
    }
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const method = editingBlogPostId() ? 'PUT' : 'POST';
      const response = await fetch('/api/saveBlogPost', {
        method,
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newBlogPost),
      });

      if (response.ok) {
        showNotification('ุชู ุญูุธ ุงูููุงูุฉ ุจูุฌุงุญ.', 'success');
        setNewBlogPost({ id: null, title: '', content: '' });
        setEditingBlogPostId(null);
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูููุงูุฉ.', 'error');
      }
    } catch (error) {
      console.error('Error saving blog post:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูููุงูุฉ.', 'error');
    }
  };

  const handleEditBlogPost = (post) => {
    setNewBlogPost({ ...post });
    setEditingBlogPostId(post.id);
  };

  const handleDeleteBlogPost = async (id) => {
    if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูููุงูุฉุ')) return;
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const response = await fetch('/api/saveBlogPost', {
        method: 'DELETE',
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ id }),
      });

      if (response.ok) {
        showNotification('ุชู ุญุฐู ุงูููุงูุฉ ุจูุฌุงุญ.', 'success');
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูููุงูุฉ.', 'error');
      }
    } catch (error) {
      console.error('Error deleting blog post:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูููุงูุฉ.', 'error');
    }
  };

  const handleSaveShopItem = async () => {
    if (!newShopItem.name || !newShopItem.price) {
      showNotification('ูุฑุฌู ุชุนุจุฆุฉ ุงูุญููู ุงููุทููุจุฉ.', 'error');
      return;
    }
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const method = editingShopItemId() ? 'PUT' : 'POST';
      const response = await fetch('/api/saveShopItem', {
        method,
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newShopItem),
      });

      if (response.ok) {
        showNotification('ุชู ุญูุธ ุงูููุชุฌ ุจูุฌุงุญ.', 'success');
        setNewShopItem({ id: null, name: '', description: '', price: '', imageUrl: '' });
        setEditingShopItemId(null);
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูููุชุฌ.', 'error');
      }
    } catch (error) {
      console.error('Error saving shop item:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูููุชุฌ.', 'error');
    }
  };

  const handleEditShopItem = (item) => {
    setNewShopItem({ ...item });
    setEditingShopItemId(item.id);
  };

  const handleDeleteShopItem = async (id) => {
    if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูููุชุฌุ')) return;
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const response = await fetch('/api/saveShopItem', {
        method: 'DELETE',
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ id }),
      });

      if (response.ok) {
        showNotification('ุชู ุญุฐู ุงูููุชุฌ ุจูุฌุงุญ.', 'success');
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูููุชุฌ.', 'error');
      }
    } catch (error) {
      console.error('Error deleting shop item:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูููุชุฌ.', 'error');
    }
  };

  const handleDeleteMessage = async (id) => {
    if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูุฑุณุงูุฉุ')) return;
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const response = await fetch('/api/deleteMessage', {
        method: 'DELETE',
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ id }),
      });

      if (response.ok) {
        showNotification('ุชู ุญุฐู ุงูุฑุณุงูุฉ ุจูุฌุงุญ.', 'success');
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุฑุณุงูุฉ.', 'error');
      }
    } catch (error) {
      console.error('Error deleting message:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุฑุณุงูุฉ.', 'error');
    }
  };

  const handleDeleteUser = async (id) => {
    if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุณุชุฎุฏูุ')) return;
    try {
      const { data: { session } } = await supabase.auth.getSession();
      const response = await fetch('/api/deleteUser', {
        method: 'DELETE',
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ id }),
      });

      if (response.ok) {
        showNotification('ุชู ุญุฐู ุงููุณุชุฎุฏู ุจูุฌุงุญ.', 'success');
        fetchData();
      } else {
        const data = await response.json();
        showNotification(data.error || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงููุณุชุฎุฏู.', 'error');
      }
    } catch (error) {
      console.error('Error deleting user:', error);
      showNotification('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงููุณุชุฎุฏู.', 'error');
    }
  };

  return (
    <div class="h-full flex flex-col items-center p-4 text-gray-800 pt-8 pb-16">
      <NotificationComponent />
      <button
        onClick={() => navigate('/')}
        class="self-start mb-4 text-2xl cursor-pointer"
        aria-label="ุงูุนูุฏุฉ"
      >
        ๐
      </button>
      <h1 class="text-4xl font-bold text-purple-600 mb-6">ููุญุฉ ุงูุชุญูู ุงูุฅุฏุงุฑูุฉ</h1>

      <div class="w-full max-w-md mb-6">
        <label class="block mb-2 text-lg font-semibold text-gray-700">ุงุฎุชุฑ ุงููุณู:</label>
        <select
          class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent cursor-pointer"
          value={activeTab()}
          onInput={(e) => setActiveTab(e.target.value)}
        >
          <option value="pages">ุงูุตูุญุงุช</option>
          <option value="blogPosts">ุงูููุงูุงุช</option>
          <option value="shopItems">ุงูููุชุฌุงุช</option>
          <option value="messages">ุงูุฑุณุงุฆู</option>
          <option value="users">ุงููุณุชุฎุฏููู</option>
        </select>
      </div>

      <Show when={!loading()} fallback={<Loader />}>
        <div class="w-full max-w-4xl bg-white rounded-lg shadow-lg p-6">
          <Show when={activeTab() === 'pages'}>
            <h2 class="text-2xl font-bold mb-4 text-purple-600">ุฅุฏุงุฑุฉ ุงูุตูุญุงุช</h2>
            <div class="mb-6">
              <label class="block mb-2 text-lg font-semibold text-gray-700">{editingPageId() ? 'ุชุนุฏูู ุงูุตูุญุฉ' : 'ุฅุถุงูุฉ ุตูุญุฉ ุฌุฏูุฏุฉ'}</label>
              <input
                type="text"
                placeholder="ุนููุงู ุงูุตูุญุฉ"
                value={newPage.title}
                onInput={(e) => setNewPage('title', e.target.value)}
                class="w-full p-3 mb-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              />
              <textarea
                placeholder="ูุญุชูู ุงูุตูุญุฉ"
                value={newPage.content}
                onInput={(e) => setNewPage('content', e.target.value)}
                class="w-full p-3 mb-2 h-32 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              ></textarea>
              <div class="flex space-x-reverse space-x-4">
                <button
                  onClick={handleSavePage}
                  class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                >
                  {editingPageId() ? 'ุชุญุฏูุซ' : 'ุญูุธ'}
                </button>
                <Show when={editingPageId()}>
                  <button
                    onClick={() => {
                      setNewPage({ id: null, title: '', content: '' });
                      setEditingPageId(null);
                    }}
                    class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                  >
                    ุฅูุบุงุก
                  </button>
                </Show>
              </div>
            </div>
            <Show when={pagesData.pages.length > 0} fallback={<p class="text-center">ูุง ุชูุฌุฏ ุตูุญุงุช.</p>}>
              <For each={pagesData.pages}>
                {(page) => (
                  <div class="mb-4 p-4 bg-gray-50 rounded-lg shadow-md flex flex-col md:flex-row justify-between items-start md:items-center">
                    <div class="flex-grow mb-4 md:mb-0">
                      <h3 class="text-xl font-bold mb-2">{page.title}</h3>
                      <p class="text-gray-700 whitespace-pre-wrap">{page.content}</p>
                      <p class="text-sm text-gray-500 mt-2">{new Date(page.created_at).toLocaleDateString()}</p>
                    </div>
                    <div class="flex space-x-reverse space-x-2">
                      <button
                        onClick={() => handleEditPage(page)}
                        class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                      >
                        ุชุนุฏูู
                      </button>
                      <button
                        onClick={() => handleDeletePage(page.id)}
                        class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                      >
                        ุญุฐู
                      </button>
                    </div>
                  </div>
                )}
              </For>
            </Show>
          </Show>

          <Show when={activeTab() === 'blogPosts'}>
            <h2 class="text-2xl font-bold mb-4 text-purple-600">ุฅุฏุงุฑุฉ ุงูููุงูุงุช</h2>
            <div class="mb-6">
              <label class="block mb-2 text-lg font-semibold text-gray-700">{editingBlogPostId() ? 'ุชุนุฏูู ุงูููุงูุฉ' : 'ุฅุถุงูุฉ ููุงูุฉ ุฌุฏูุฏุฉ'}</label>
              <input
                type="text"
                placeholder="ุนููุงู ุงูููุงูุฉ"
                value={newBlogPost.title}
                onInput={(e) => setNewBlogPost('title', e.target.value)}
                class="w-full p-3 mb-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              />
              <textarea
                placeholder="ูุญุชูู ุงูููุงูุฉ"
                value={newBlogPost.content}
                onInput={(e) => setNewBlogPost('content', e.target.value)}
                class="w-full p-3 mb-2 h-32 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              ></textarea>
              <div class="flex space-x-reverse space-x-4">
                <button
                  onClick={handleSaveBlogPost}
                  class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                >
                  {editingBlogPostId() ? 'ุชุญุฏูุซ' : 'ุญูุธ'}
                </button>
                <Show when={editingBlogPostId()}>
                  <button
                    onClick={() => {
                      setNewBlogPost({ id: null, title: '', content: '' });
                      setEditingBlogPostId(null);
                    }}
                    class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                  >
                    ุฅูุบุงุก
                  </button>
                </Show>
              </div>
            </div>
            <Show when={blogPostsData.blogPosts.length > 0} fallback={<p class="text-center">ูุง ุชูุฌุฏ ููุงูุงุช.</p>}>
              <For each={blogPostsData.blogPosts}>
                {(post) => (
                  <div class="mb-4 p-4 bg-gray-50 rounded-lg shadow-md flex flex-col md:flex-row justify-between items-start md:items-center">
                    <div class="flex-grow mb-4 md:mb-0">
                      <h3 class="text-xl font-bold mb-2">{post.title}</h3>
                      <p class="text-gray-700 whitespace-pre-wrap">{post.content}</p>
                      <p class="text-sm text-gray-500 mt-2">{new Date(post.created_at).toLocaleDateString()}</p>
                    </div>
                    <div class="flex space-x-reverse space-x-2">
                      <button
                        onClick={() => handleEditBlogPost(post)}
                        class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                      >
                        ุชุนุฏูู
                      </button>
                      <button
                        onClick={() => handleDeleteBlogPost(post.id)}
                        class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                      >
                        ุญุฐู
                      </button>
                    </div>
                  </div>
                )}
              </For>
            </Show>
          </Show>

          <Show when={activeTab() === 'shopItems'}>
            <h2 class="text-2xl font-bold mb-4 text-purple-600">ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</h2>
            <div class="mb-6">
              <label class="block mb-2 text-lg font-semibold text-gray-700">{editingShopItemId() ? 'ุชุนุฏูู ุงูููุชุฌ' : 'ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ'}</label>
              <input
                type="text"
                placeholder="ุงุณู ุงูููุชุฌ"
                value={newShopItem.name}
                onInput={(e) => setNewShopItem('name', e.target.value)}
                class="w-full p-3 mb-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              />
              <input
                type="text"
                placeholder="ุงููุตู"
                value={newShopItem.description}
                onInput={(e) => setNewShopItem('description', e.target.value)}
                class="w-full p-3 mb-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              />
              <input
                type="number"
                placeholder="ุงูุณุนุฑ"
                value={newShopItem.price}
                onInput={(e) => setNewShopItem('price', e.target.value)}
                class="w-full p-3 mb-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              />
              <input
                type="text"
                placeholder="ุฑุงุจุท ุงูุตูุฑุฉ"
                value={newShopItem.imageUrl}
                onInput={(e) => setNewShopItem('imageUrl', e.target.value)}
                class="w-full p-3 mb-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent"
              />
              <div class="flex space-x-reverse space-x-4">
                <button
                  onClick={handleSaveShopItem}
                  class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                >
                  {editingShopItemId() ? 'ุชุญุฏูุซ' : 'ุญูุธ'}
                </button>
                <Show when={editingShopItemId()}>
                  <button
                    onClick={() => {
                      setNewShopItem({ id: null, name: '', description: '', price: '', imageUrl: '' });
                      setEditingShopItemId(null);
                    }}
                    class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                  >
                    ุฅูุบุงุก
                  </button>
                </Show>
              </div>
            </div>
            <Show when={shopItemsData.shopItems.length > 0} fallback={<p class="text-center">ูุง ุชูุฌุฏ ููุชุฌุงุช.</p>}>
              <For each={shopItemsData.shopItems}>
                {(item) => (
                  <div class="mb-4 p-4 bg-gray-50 rounded-lg shadow-md flex flex-col md:flex-row justify-between items-start md:items-center">
                    <div class="flex-grow mb-4 md:mb-0">
                      <h3 class="text-xl font-bold mb-2">{item.name}</h3>
                      <p class="text-gray-700 mb-2">{item.description}</p>
                      <p class="text-gray-700 font-semibold">ุงูุณุนุฑ: {item.price} ุฏููุงุฑ</p>
                      <p class="text-sm text-gray-500 mt-2">{new Date(item.created_at).toLocaleDateString()}</p>
                    </div>
                    <div class="flex space-x-reverse space-x-2">
                      <button
                        onClick={() => handleEditShopItem(item)}
                        class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                      >
                        ุชุนุฏูู
                      </button>
                      <button
                        onClick={() => handleDeleteShopItem(item.id)}
                        class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                      >
                        ุญุฐู
                      </button>
                    </div>
                  </div>
                )}
              </For>
            </Show>
          </Show>

          <Show when={activeTab() === 'messages'}>
            <h2 class="text-2xl font-bold mb-4 text-purple-600">ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู</h2>
            <Show when={messagesData.messages.length > 0} fallback={<p class="text-center">ูุง ุชูุฌุฏ ุฑุณุงุฆู.</p>}>
              <For each={messagesData.messages}>
                {(message) => (
                  <div class="mb-4 p-4 bg-gray-50 rounded-lg shadow-md flex flex-col">
                    <h4 class="text-lg font-bold mb-2">ุงูุงุณู: {message.name}</h4>
                    <p class="text-gray-700 mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: {message.email}</p>
                    <Show when={message.phone}>
                      <p class="text-gray-700 mb-1">ุฑูู ุงููุงุชู: {message.phone}</p>
                    </Show>
                    <p class="text-gray-700 mb-1">ุงูููุน: {message.type === 'contact' ? 'ุงุชุตู ุจูุง' : 'ุงูุถู ุฅูููุง'}</p>
                    <p class="text-gray-700">ุงูุฑุณุงูุฉ: {message.message}</p>
                    <button
                      onClick={() => handleDeleteMessage(message.id)}
                      class="mt-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                    >
                      ุญุฐู
                    </button>
                  </div>
                )}
              </For>
            </Show>
          </Show>

          <Show when={activeTab() === 'users'}>
            <h2 class="text-2xl font-bold mb-4 text-purple-600">ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h2>
            <Show when={usersData.users.length > 0} fallback={<p class="text-center">ูุง ููุฌุฏ ูุณุชุฎุฏููู.</p>}>
              <For each={usersData.users}>
                {(user) => (
                  <div class="mb-4 p-4 bg-gray-50 rounded-lg shadow-md flex flex-col md:flex-row justify-between items-start md:items-center">
                    <div class="flex-grow mb-4 md:mb-0">
                      <p class="text-gray-700 mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: {user.email}</p>
                      <p class="text-gray-700 mb-1">ุงููุนุฑู: {user.id}</p>
                      <p class="text-gray-700 mb-1">ุชุงุฑูุฎ ุงูุฅูุดุงุก: {new Date(user.created_at).toLocaleDateString()}</p>
                    </div>
                    <div class="flex space-x-reverse space-x-2">
                      <Show when={user.email !== 'daoudi.abdennour@gmail.com'}>
                        <button
                          onClick={() => handleDeleteUser(user.id)}
                          class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-300 ease-in-out transform hover:scale-105 cursor-pointer"
                        >
                          ุญุฐู
                        </button>
                      </Show>
                    </div>
                  </div>
                )}
              </For>
            </Show>
          </Show>

          <Show when={
            activeTab() !== 'pages' &&
            activeTab() !== 'blogPosts' &&
            activeTab() !== 'shopItems' &&
            activeTab() !== 'messages' &&
            activeTab() !== 'users'
          }>
            <div class="text-center text-gray-500">
              <p>ูุฐุง ุงููุณู ููุฏ ุงูุชุทููุฑ. ูุฑุฌู ุงูุงูุชุธุงุฑ ุญุชู ูุชู ุชุญุฏูุซู ูุฑูุจูุง.</p>
            </div>
          </Show>
        </div>
      </Show>
    </div>
  );
}

export default AdminDashboard;